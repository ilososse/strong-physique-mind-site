<!DOCTYPE html>
<html lang="fr">

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
  // 1) Connexion base de donn√©es Supabase pour la partie communaut√©
  const SUPABASE_URL = "https://lmblqxwssrxucbtowfkq.supabase.co";
  const SUPABASE_ANON_KEY = "sb_publishable_8cLzA_3Ud6AaLSi8mTf1Gw_4lJZTLjs";

  const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
</script>
  
<head>
  <meta charset="UTF-8" />
  <title>Programmes & progression ‚Äì Calisth√©nie</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" type="image/png" href="images/favicon.png">

  <style>

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 0;
      padding: 0;
      background: #f7f7f7;
      color: #111;
    }

    header {
      padding: 16px 24px;
      border-bottom: 1px solid #ddd;
      background: #ffffff;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    #public-feed{
  display: flex;
  gap: 12px;
  overflow-x: auto;           /* scroll horizontal */
  padding-bottom: 8px;        /* √©vite que la scrollbar cache le bas */
  scroll-snap-type: x mandatory; /* snap sympa */
  -webkit-overflow-scrolling: touch; /* inertie iOS */
}

    #public-feed > div{
      font-size: 12px;
      flex: 0 0 320px;            /* largeur fixe de ‚Äúcarte‚Äù */
      scroll-snap-align: start;
    }

    .logo {
    display: flex;
    align-items: center;
    gap: 10px;
    font-weight: 700;
    letter-spacing: 0.03em;
    font-size: 16px;
    color: #111;
    text-decoration: none; /* retire le soulignement */
  }

    .logo img {
        height: 36px;
        width: auto;
        display: block;
      }

    .logo:hover {
        opacity: 0.85; /* petit effet subtil sexy */
      }



    nav a {
      margin-left: 16px;
      text-decoration: none;
      color: #333;
      font-size: 14px;
    }

    nav a:hover {
      text-decoration: underline;
    }

    main {
      max-width: 960px;
      margin: 0 auto;
      padding: 24px 16px 40px;
    }

    .hero {
      margin-bottom: 28px;
      padding: 20px 18px;
      border-radius: 16px;
      background: #ffffff;
      box-shadow: 0 2px 8px rgba(0,0,0,0.04);
    }

    .hero h1 {
      margin-top: 0;
      margin-bottom: 10px;
      font-size: 24px;
    }

    .hero p {
      margin: 0 0 8px;
      line-height: 1.5;
      font-size: 14px;
    }

    /* PROGRAMMES */

    .workouts {
      margin-bottom: 32px;
    }

    .workouts h2 {
      margin-bottom: 8px;
      font-size: 20px;
    }

    .workouts p {
      margin-bottom: 16px;
      color: #555;
      font-size: 14px;
    }

    .workout-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 16px;
    }

    .workout-card {
      background: #ffffff;
      border-radius: 12px;
      padding: 16px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.04);
    }

    .workout-card h3 {
      margin-top: 0;
      margin-bottom: 8px;
      font-size: 16px;
    }

    .workout-card ul {
      padding-left: 20px;
      margin: 8px 0;
      font-size: 14px;
    }

    .workout-card p {
      font-size: 13px;
      color: #555;
    }

    .workout-level {
      display: inline-block;
      font-size: 11px;
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid #ddd;
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .section-title {
      font-size: 18px;
      margin-bottom: 8px;
    }

    /* JOURNAL STRUCTUR√â */

    .structured-log {
      margin-bottom: 32px;
      background: #ffffff;
      border-radius: 12px;
      padding: 16px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.04);
    }

    .structured-log-header {
      margin-bottom: 12px;
    }

    .session-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-bottom: 12px;
      font-size: 13px;
    }

    .session-meta label {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .session-meta input,
    .session-meta select {
      padding: 6px 8px;
      border-radius: 6px;
      border: 1px solid #ccc;
      font-size: 13px;
    }

    .session-table-wrapper {
      overflow-x: auto;
      margin-bottom: 10px;
    }

    table.session-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 13px;
    }

    .session-table th,
    .session-table td {
      border: 1px solid #e2e2e2;
      padding: 6px 4px;
      text-align: center;
    }

    .session-table th {
      background: #fafafa;
      font-weight: 500;
    }

    .session-table input[type="text"],
    .session-table input[type="number"] {
      width: 100%;
      box-sizing: border-box;
      border-radius: 4px;
      border: 1px solid #ccc;
      padding: 4px 6px;
      font-size: 12px;
    }

    .session-actions {
      display: flex;
      gap: 8px;
      justify-content: flex-end;
      margin-top: 8px;
      flex-wrap: wrap;
    }

    .btn {
      padding: 7px 12px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-size: 13px;
    }

    .btn-secondary {
      background: #eee;
    }

    .btn-primary {
      background: #000;
      color: #fff;
    }

    .remove-row-btn {
      border: none;
      background: transparent;
      cursor: pointer;
      font-size: 14px;
    }

    .info {
      margin-top: 8px;
      font-size: 11px;
      color: #555;
    }

    .dashboard {
      margin-bottom: 32px;
      background: #ffffff;
      border-radius: 12px;
      padding: 16px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.04);
    }

    .dashboard-controls {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-bottom: 12px;
      font-size: 13px;
      align-items: flex-end;
    }
    .dashboard-controls .control {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .exercise-row {
      display: flex;
      gap: 4px;
      align-items: center;
    }

    .exercise-row select,
    .exercise-row input {
      height: 32px;
    }


    .dashboard-controls label {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .dashboard-controls select,
    .dashboard-controls input{
      height:34px;
      padding:6px 10px;
      font-size:13px;
      border:1px solid #ccc;
      border-radius:8px;
      background:#fff;
      box-sizing:border-box;
      min-width:180px;
    }

    #exercise-chart {
      max-width: 100%;
      margin-top: 10px;
    }

    .chart-wrapper {
      position: relative;
      height: 260px;       /* hauteur fixe du graphique */
      margin-top: 10px;
    }

    #exercise-chart {
      width: 100%;
      height: 100%;
      display: block;
    }
#sessions-history {
  display: flex;
  gap: 12px;
  overflow-x: auto;
  padding-bottom: 8px;
  scroll-snap-type: x mandatory;
  -webkit-overflow-scrolling: touch;
}

#sessions-history > .session-card {
  flex: 0 0 320px;
  scroll-snap-align: start;
}

    #sessions-history {
  display: flex;
  gap: 12px;
  overflow-x: auto;
  padding-bottom: 8px;
  scroll-snap-type: x mandatory;
  -webkit-overflow-scrolling: touch;
}

#sessions-history > .session-card {
  flex: 0 0 400;
  scroll-snap-align: start;
}
.session-card {

  font-size: 12px;
  line-height: 1.5;
  background: #f5f5f5;
  border: 1px solid #eee;
  border-radius: 12px;
  padding: 12px;
}


    .session-card-header {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      justify-content: space-between;
      margin-bottom: 6px;
    }

    .session-card-header span.label {
      font-weight: 600;
    }

    .session-card-exos {
      margin: 0;
      padding-left: 16px;
    }

    /* JOURNAL LIBRE */

    .nav-posts {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: flex-start;
      margin-bottom: 16px;
      margin-top: 10px;
    }

    .nav-posts button {
      padding: 8px 16px;
      border-radius: 999px;
      border: 1px solid #ccc;
      background: #fff;
      cursor: pointer;
      font-size: 13px;
    }

    .nav-posts button.active {
      border-color: #000;
      font-weight: 600;
    }

    .post {
      display: none;
      background: #ffffff;
      border-radius: 12px;
      padding: 16px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.04);
      margin-bottom: 30px;
    }

    .post h3 {
      margin-top: 0;
      margin-bottom: 8px;
      font-size: 16px;
    }

    .post textarea {
      width: 100%;
      min-height: 200px;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #ccc;
      resize: vertical;
      font-family: inherit;
      font-size: 14px;
    }

    .post-actions {
      margin-top: 10px;
      display: flex;
      gap: 10px;
      justify-content: flex-end;
    }

    .post-actions button {
      padding: 8px 14px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-size: 13px;
    }

    .btn-save {
      background: #000;
      color: #fff;
    }

    .btn-reset {
      background: #eee;
    }

    .delete-session-btn {
  margin-top: 8px;
  background: #ffdddd;
  color: #900;
  border: 1px solid #cc0000;
  padding: 6px 10px;
  border-radius: 6px;
  font-size: 12px;
  cursor: pointer;
}

.delete-session-btn:hover {
  background: #ffcccc;
}

  </style>
</head>
<body>
  <header>
    <a href="index.html" class="logo">
  <img src="images/logo.png" alt="Logo Calisth√©nie & ambition">
  <span>Calisth√©nie & ambition</span>
</a>


    <nav>
      <a href="index.html">Accueil</a>
      <a href="entrainements.html">Programmes & progression</a>
    </nav>
  </header>

  <main>
    <!-- UI for login publications and feed -->    

<section class="structured-log" style="margin-top:16px;">
  <h2 class="section-title">Communaut√©</h2>
  <p style="font-size:14px;color:#555;">
    Publie tes s√©ances (pseudo) et consulte le feed public pour t‚Äôinspirer. Attention, une fois ton pseudo saisi et ta s√©ance publi√©e, il n‚Äôest plus modifiable !
  </p>

  <div class="session-meta" style="align-items:flex-end;">
    <label>
      Email (login)
      <input id="auth-email" type="email" placeholder="ton@email.com">
    </label>

    <label>
      Mot de passe
      <input id="auth-pass" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
    </label>

    <button class="btn btn-secondary" type="button" onclick="signup()">
      S‚Äôinscrire
    </button>
    <button class="btn btn-primary" type="button" onclick="login();await initUsernameUI();">
      Se connecter
    </button>
    <button class="btn btn-secondary" type="button" onclick="logout();await initUsernameUI();">
      D√©connexion
    </button>
  </div>

  <div class="session-meta" style="margin-top:10px; align-items:flex-end;">
    <label>
      Pseudo (public)
      <input id="public-username" type="text" placeholder="ex: cali_ambition">
    </label>

    <button class="btn btn-primary" type="button" onclick="publishLastSession()">
      Publier ma derni√®re s√©ance
    </button>
  </div>

  <div class="info" id="community-info"></div>

  <hr style="border:none;border-top:1px solid #eee;margin:14px 0;">

  <h3 style="margin:0 0 8px;font-size:15px;">Feed public (derni√®res s√©ances)</h3>
  <div id="public-feed"></div>




</section>

    <!-- INTRO -->
    <section class="hero">
      <h1>Programmes & journal de progression</h1>
      <p>
        Cette page pr√©sente un outil cl√© pour qui cr√©e la diff√©rence en terme de motivation : le suivi automatis√© de chaque s√©ance que tu r√©alises.
        En tant qu'athl√®te, j'ai longuement r√™v√© d'avoir un tel outil √† ma disposition : d√©sormais, il est l√†, le hack, √† toi de jouer !
        Je t'ai aussi propos√© trois grandes classes de niveaux ‚Äì <strong>d√©butant</strong>, <strong>interm√©diaire</strong>
        et <strong>avanc√© / pro</strong> ‚Äì avec des exemples de structures d‚Äôentra√Ænement. Il y a √©videmment une infinit√© de fa√ßons de combiner les exercices. Ma proposition est un point de d√©part. Sois libre de l'adapter √† ton niveau, en int√©grant des exercices √† difficult√© variable !
      </p>
      <p>
        L‚Äôid√©e n‚Äôest pas de ‚Äúfinir parfaitement‚Äù un programme,ou de le suivre √† la lettre, mais de :
      </p>
      <ul style="margin-top: 4px; padding-left: 18px; font-size: 14px;">
        <li>choisir un niveau qui te parle (ou en tester plusieurs),</li>
        <li>observer comment ton corps r√©agit aux exercices,</li>
        <li>documenter ta progression et tes ressentis au fil des s√©ances avec le super outil que je te propose en bas,</li>
        <li>appr√©cier au fil du temps ton progr√®s √† travers les courbes r√©alis√©es automatiquement √† partir de tes s√©ances.</li>
        <li> ‚ö†Ô∏è il est extr√™mement important de ne pas oublier de r√©aliser un √©chauffement des muscles avant d'attaquer les exercices.</li>
        <li> je t'invite √† lire 
  <a href="echauffement.html" target="_blank" style="text-decoration:none; color:#111; font-weight:500;">
    mon article
  </a> 
  (en cours de r√©daction) sur l'√©chauffement pr√©sentant un exemple d'exercices pr√©parant √† l'effort physique.
</li>

      </ul>
      <p style="margin-top: 8px;">
        Plus tard, ces structures pourront √™tre enrichies, adapt√©es, ou connect√©es √† une API
        permettant de g√©n√©rer des s√©ances plus personnalis√©es.
      </p>
    </section>

    <!-- PROGRAMMES -->
    <section class="workouts">
      <h2>Programmes par niveau</h2>
      <p>
        Voici une base de travail. Tu peux t‚Äôen servir comme r√©f√©rence, comme point de d√©part,
        ou comme cadre pour organiser tes propres s√©ances.
      </p>

      <div class="workout-grid">
        <!-- D√©butant -->
        <article class="workout-card">
          <div class="workout-level">D√©butant</div>
          <h3>Routine full body simple</h3>
          <ul>
            <li>3 √ó 8‚Äì10 pompes inclin√©es (mains sur le sol / canap√©)</li>
            <li>3 √ó 10 squats au poids du corps</li>
            <li>3 √ó 20 s gainage planche</li>
            <li>3 √ó 5-10 tractions n√©gatives </li>
          </ul>
          <p>
            Objectif : apprendre les bases, sentir les mouvements, construire une premi√®re r√©gularit√©
            sans √©craser le syst√®me nerveux.
          </p>
        </article>

        <!-- Interm√©diaire -->
        <article class="workout-card">
          <div class="workout-level">Interm√©diaire</div>
          <h3>Routine traction / push</h3>
          <ul>
            <li>4 √ó 6‚Äì8 tractions strictes</li>
            <li>4 √ó 8‚Äì12 pompes classiques</li>
            <li>3 √ó 8 dips sur barres ou chaises</li>
            <li>4 x 10 s hold handstand au mur ou libre si tu es √† l'aise</li>
            <li>4 x 3-10s hold tuck planche </li>
            <li>4 x 3-7 handstand push ups si tu es tenace</li>
            

          </ul>
          <p>
            Objectif : consolider la force de base et pr√©parer le terrain pour les skills
            (muscle-up, front lever, planche variantes plus avanc√©es).
          </p>
        </article>

        <!-- Avanc√© / Pro -->
        <article class="workout-card">
          <div class="workout-level">Avanc√© / Pro</div>
          <h3>Session skills & explosivit√©</h3>
          <ul>
            <li>Muscle-up : 5‚Äì8 s√©ries de variations (explosives, assist√©es, n√©gatives)</li>
            <li>Front lever : 5 √ó 10‚Äì15 s sur ta progression actuelle (tuck, advanced tuck, straddle‚Ä¶)</li>
            <li>Handstand push ups: 4 x 3‚Äì12 (mur + freestanding)</li>
            <li>Planche : 5 x 3-10s sur la progression la plus adapt√©e (tuck, straddle ou full si tu te sens monstrueux)</li>
          </ul>
          <p>
            Objectif : d√©velopper les skills, la musculature, et la force d'un ogre.
          </p>
        </article>
      </div>
    </section>

    <!-- JOURNAL STRUCTUR√â (TABLEAU) -->
<section class="structured-log">
  <div class="structured-log-header">
    <h2 class="section-title">Journal structur√© de s√©ance</h2>
    <p style="font-size: 14px; color:#555;">
      Utilise ce tableau pour consigner une s√©ance pr√©cise : date, niveau, dur√©e, exercices,
      √©ventuel lest, r√©p√©titions par s√©rie et ressenti global. Les donn√©es sont stock√©es dans ce navigateur.
    </p>
  </div>

  <div class="session-meta">
    <label>
      Date de la s√©ance
      <input type="date" id="session-date" />
    </label>

    <label>
      Dur√©e (minutes)
      <input type="number" id="session-duration" min="0" step="1" />
    </label>
  </div>

  <div class="session-table-wrapper">
    <table class="session-table">
      <thead>
        <tr>
          <th>Exercice</th>
          <th>Lest (kg)</th>
          <th>S√©rie 1</th>
          <th>S√©rie 2</th>
          <th>S√©rie 3</th>
          <th>S√©rie 4</th>
          <th>S√©rie 5</th>
          <th>S√©rie 6</th>
          <th>S√©rie 7</th>
          <th>S√©rie 8</th>
          <th>Ressenti</th>
          <th></th>
        </tr>
      </thead>

      <tbody id="session-rows">
        <!-- lignes ajout√©es en JS -->
      </tbody>
    </table>
  </div>

  <div class="session-actions">
    <button class="btn btn-secondary" type="button" onclick="addExerciseRow()">
      Ajouter un exercice
    </button>
    <button class="btn btn-primary" type="button" onclick="saveStructuredSession()">
      Enregistrer la s√©ance
    </button>
  </div>

  <div class="info" id="session-save-info"></div>
        <div class="sessions-history">
        <h3 style="font-size: 15px; margin: 6px 0 4px;">Historique des s√©ances</h3>
        <p style="font-size: 12px; color:#555; margin:0 0 6px;">
          Les derni√®res s√©ances enregistr√©es s‚Äôaffichent ci-dessous (stock√©es uniquement dans ce navigateur).
        </p>
        <div id="sessions-history"></div>
      </div>

</section>

    <!-- TABLEAU DE BORD -->
    <section class="dashboard">
      <h2 class="section-title">Tableau de bord de progression</h2>
      <p style="font-size: 14px; color:#555;">
        S√©lectionne un exercice et une m√©trique pour visualiser ta progression au fil des s√©ances.
        Les donn√©es proviennent de ton journal structur√© et restent stock√©es uniquement dans ce navigateur.
      </p>


      <div class="dashboard-controls">
      <div class="control">
        <label>Exercice √† analyser</label>
        <div class="exercise-row">
          <select id="dashboard-exercise">
            <option value="Tractions">Tractions</option>
            <option value="Pompes">Pompes</option>
            <option value="Dips">Dips</option>
            <option value="Planche lean">Planche lean</option>
            <option value="Tuck planche">Tuck planche</option>
            <option value="Straddle planche">Straddle planche</option>
            <option value="Full planche">Full planche</option>
            <option value="Handstand">Handstand</option>
            <option value="One Arm Handstand">One Arm Handstand</option>
            <option value="Handstand Push Up">Handstand Push Up</option>
            <option value="Human Flag">Human Flag</option>
            <option value="Front Lever">Front Lever</option>
            <option value="Muscle Up">Muscle Up</option>
            <option value="__custom_reps__">Autre... (Reps)</option>
            <option value="__custom_hold__">Autre... (Hold)</option>

          </select>

          <input
            id="custom-exercise"
            type="text"
            placeholder="Nom de l'exercice"
            style="display:none;"
          />
        </div>
      </div>

      <div class="control">
        <label>M√©trique</label>
        <select id="dashboard-metric"></select>
      </div>
    </div>


    <div class="chart-wrapper">
      <canvas id="exercise-chart"></canvas>
    </div>

      <div class="info" id="dashboard-info"></div>
    </section>



    <!-- JOURNAL LIBRE -->
    <section>
      <h2 class="section-title">Journal d‚Äô√©volution libre</h2>
      <p style="font-size: 14px; color:#555;">
        Utilise cet espace comme un carnet personnel : note ce que tu observes en toi
        selon le niveau que tu explores (d√©butant, interm√©diaire, avanc√©).
        C‚Äôest stock√© uniquement dans ton navigateur.
      </p>

      <div class="nav-posts">
        <button onclick="showPost(1)" id="btn-post-1">Journal ‚Äì Niveau d√©butant</button>
        <button onclick="showPost(2)" id="btn-post-2">Journal ‚Äì Niveau interm√©diaire</button>
        <button onclick="showPost(3)" id="btn-post-3">Journal ‚Äì Niveau avanc√© / pro</button>
        <button onclick="showPost(4)" id="btn-post-4">Notes libres</button>
      </div>

      <section class="post" id="post-1">
        <h3>Journal ‚Äì Niveau d√©butant</h3>
        <textarea id="textarea-1" placeholder="Comment ton corps r√©agit-il aux bases ? Ressenti sur la respiration, la technique, la confiance, la r√©gularit√©‚Ä¶"></textarea>
        <div class="post-actions">
          <button class="btn-reset" onclick="resetPost(1)">R√©initialiser</button>
          <button class="btn-save" onclick="savePost(1)">Enregistrer</button>
        </div>
        <div class="info" id="info-1"></div>
      </section>

      <section class="post" id="post-2">
        <h3>Journal ‚Äì Niveau interm√©diaire</h3>
        <textarea id="textarea-2" placeholder="Qu‚Äôest-ce qui devient plus facile ? O√π sont les blocages ? Comment √©volue ta motivation, ton rapport aux s√©ances‚Ä¶"></textarea>
        <div class="post-actions">
          <button class="btn-reset" onclick="resetPost(2)">R√©initialiser</button>
          <button class="btn-save" onclick="savePost(2)">Enregistrer</button>
        </div>
        <div class="info" id="info-2"></div>
      </section>

      <section class="post" id="post-3">
        <h3>Journal ‚Äì Niveau avanc√© / pro</h3>
        <textarea id="textarea-3" placeholder="Quelles sont les difficult√©s mentales li√©es aux skills ? Frustration, perfectionnisme, ego, gestion de la fatigue‚Ä¶"></textarea>
        <div class="post-actions">
          <button class="btn-reset" onclick="resetPost(3)">R√©initialiser</button>
          <button class="btn-save" onclick="savePost(3)">Enregistrer</button>
        </div>
        <div class="info" id="info-3"></div>
      </section>

      <section class="post" id="post-4">
        <h3>Notes libres</h3>
        <textarea id="textarea-4" placeholder="Id√©es, objectifs, prises de conscience, scripts de contenu, choses que tu veux garder en m√©moire‚Ä¶"></textarea>
        <div class="post-actions">
          <button class="btn-reset" onclick="resetPost(4)">R√©initialiser</button>
          <button class="btn-save" onclick="savePost(4)">Enregistrer</button>
        </div>
        <div class="info" id="info-4"></div>
      </section>
    </section>
  </main>


  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>


  <script>
    /* ---------- JOURNAL STRUCTUR√â ---------- */

    // Exercices √† r√©p√©titions et √† hold
    const REPS_EXERCISES = [
      "Tractions",
      "Pompes",
      "Dips",
      "Handstand Push Up",
      "Muscle Up",
    ];

    const HOLD_EXERCISES = [
      "Planche lean",
      "Tuck planche",
      "Straddle planche",
      "Full planche",
      "Handstand",
      "One Arm Handstand",
      "Human Flag",
      "Front Lever",
      "Tuck planche",
    ];

    function isHoldExercise(name) {
      if (isCustomHoldSelected()) return true;
      return HOLD_EXERCISES.includes(name);
    }

    function getSelectedExerciseName() {
      const exerciseSelect = document.getElementById("dashboard-exercise");
      const customInput = document.getElementById("custom-exercise");
      if (!exerciseSelect) return "";

      const v = exerciseSelect.value;
      if (v === "__custom_reps__" || v === "__custom_hold__") {
        return (customInput?.value || "").trim();
      }
      return v;
    }

function isCustomHoldSelected() {
  const exerciseSelect = document.getElementById("dashboard-exercise");
  return exerciseSelect?.value === "__custom_hold__";
}


function createExerciseRow(data) {
  const tr = document.createElement("tr");

  tr.innerHTML = `
    <td>
      <select class="ex-name">
        <option value="">‚Äì S√©lectionne ‚Äì</option>
        <option value="Tractions">Tractions</option>
        <option value="Pompes">Pompes</option>
        <option value="Dips">Dips</option>
        <option value="Planche lean">Planche lean</option>
        <option value="Tuck planche">Tuck planche</option>
        <option value="Straddle planche">Straddle planche</option>
        <option value="Full planche">Full planche</option>
        <option value="Handstand">Handstand</option>
        <option value="One Arm Handstand">One Arm Handstand</option>
        <option value="Handstand Push Up">Handstand Push Up</option>
        <option value="Human Flag">Human Flag</option>
        <option value="Front Lever">Front Lever</option>
        <option value="Muscle Up">Muscle Up</option>
        <option value="__custom_reps__">Autre... (Reps)</option>
        <option value="__custom_hold__">Autre... (Hold)</option>
      </select>
      <input
    type="text"
    class="ex-custom"
    placeholder="Nom de l'exercice‚Ä¶"
    style="display:none; margin-top:6px;"
  />
</td>

    </td>
    <td><input type="number" class="ex-weight" min="0" step="0.5" value="${data?.weight ?? 0}"></td>
    <td><input type="number" class="ex-s1" min="0" step="1" value="${data?.s1 || ""}"></td>
    <td><input type="number" class="ex-s2" min="0" step="1" value="${data?.s2 || ""}"></td>
    <td><input type="number" class="ex-s3" min="0" step="1" value="${data?.s3 || ""}"></td>
    <td><input type="number" class="ex-s4" min="0" step="1" value="${data?.s4 || ""}"></td>
    <td><input type="number" class="ex-s5" min="0" step="1" value="${data?.s5 || ""}"></td>
    <td><input type="number" class="ex-s6" min="0" step="1" value="${data?.s6 || ""}"></td>
    <td><input type="number" class="ex-s7" min="0" step="1" value="${data?.s7 || ""}"></td>
    <td><input type="number" class="ex-s8" min="0" step="1" value="${data?.s8 || ""}"></td>

    <td><input type="text" class="ex-ressenti" placeholder="Ressenti global" value="${data?.ressenti || ""}"></td>
    <td><button class="remove-row-btn" type="button" onclick="removeExerciseRow(this)">√ó</button></td>
  `;

const select = tr.querySelector(".ex-name");
const custom = tr.querySelector(".ex-custom");

function syncRowCustom() {
  const v = select.value;
  const isCustom = (v === "__custom_reps__" || v === "__custom_hold__");
  custom.style.display = isCustom ? "block" : "none";
  if (!isCustom) custom.value = "";
}

select.addEventListener("change", () => {
  syncRowCustom();
});

syncRowCustom();


  if (data?.name) {
    tr.querySelector(".ex-name").value = data.name;
  }

  return tr;
}



    function addExerciseRow(prefillData) {
      const tbody = document.getElementById("session-rows");
      tbody.appendChild(createExerciseRow(prefillData));
    }

    function removeExerciseRow(btn) {
      const tr = btn.closest("tr");
      if (tr) tr.remove();
    }

function saveStructuredSession() {
  const dateInput = document.getElementById("session-date");
  const durationInput = document.getElementById("session-duration");
  const rows = document.querySelectorAll("#session-rows tr");
  const info = document.getElementById("session-save-info");

  if (!dateInput.value) {
    const today = new Date();
    dateInput.value = today.toISOString().slice(0, 10);
  }

  const session = {
    date: dateInput.value,
    duration: durationInput.value || "",
    exercises: []
  };

        rows.forEach(row => {
        const selectVal = row.querySelector(".ex-name").value;
        const customVal = (row.querySelector(".ex-custom")?.value || "").trim();
        const name = (selectVal === "__custom__") ? customVal : selectVal;
        const weight = row.querySelector(".ex-weight")?.value || "0";
        const s1 = row.querySelector(".ex-s1").value;
        const s2 = row.querySelector(".ex-s2").value;
        const s3 = row.querySelector(".ex-s3").value;
        const s4 = row.querySelector(".ex-s4").value;
        const s5 = row.querySelector(".ex-s5").value;
        const s6 = row.querySelector(".ex-s6").value;
        const s7 = row.querySelector(".ex-s7").value;
        const s8 = row.querySelector(".ex-s8").value;
        const ressenti = row.querySelector(".ex-ressenti").value.trim();

        if (name || s1 || s2 || s3 || s4 || ressenti || weight !== "0") {
          session.exercises.push({ name, weight, s1, s2, s3, s4, s5, s6, s7, s8, ressenti });
        }
      });

      const key = "structured-sessions";
      const existingRaw = localStorage.getItem(key);
      const existing = existingRaw ? JSON.parse(existingRaw) : [];
      existing.push(session);
      localStorage.setItem(key, JSON.stringify(existing));

      const d = new Date(session.date);
      const formatted = d.toLocaleDateString();
      info.textContent = `S√©ance enregistr√©e pour le ${formatted} (stock√©e dans ce navigateur).`;

      renderStructuredSessionsHistory(); // nouveau
      renderExerciseChart();

}

    function renderStructuredSessionsHistory() {
      const container = document.getElementById("sessions-history");
      if (!container) return;

      const raw = localStorage.getItem("structured-sessions");
      if (!raw) {
        container.innerHTML = "<p style='font-size:12px; color:#777;'>Aucune s√©ance enregistr√©e pour l‚Äôinstant.</p>";
        return;
      }

      let sessions = getStructuredSessions();

      if (!sessions.length) {
        container.innerHTML = "<p style='font-size:12px; color:#777;'>Aucune s√©ance enregistr√©e pour l‚Äôinstant.</p>";
        return;
      }

      // on affiche de la plus r√©cente √† la plus ancienne
      const reversed = sessions.slice().reverse();
      let html = "";

      reversed.forEach((s, idx) => {
        const d = new Date(s.date);
        const dateStr = isNaN(d.getTime()) ? s.date : d.toLocaleDateString();
        html += `
  <div class="session-card">
    <div class="session-card-header">
      <span class="label">S√©ance du ${dateStr}</span>
      <span>Dur√©e : ${s.duration || "‚Äì"} min</span>
    </div>

    <ul class="session-card-exos">
      ${
        (s.exercises || [])
          .map(ex => {
            const lest = ex.weight && ex.weight !== "0" ? ` (lest : ${ex.weight} kg)` : "";
            const series = [ex.s1, ex.s2, ex.s3, ex.s4, ex.s5, ex.s6, ex.s7, ex.s8]
              .filter(v => v && v !== "0")
              .join(" / ");
            const seriesText = series ? ` ‚Äì ${series} reps` : "";
            const ressenti = ex.ressenti ? ` ‚Äì ${ex.ressenti}` : "";
            return `<li>${ex.name || "Exercice"}${lest}${seriesText}${ressenti}</li>`;
          })
          .join("")
      }
    </ul>

    <button class="delete-session-btn" onclick="deleteSession(${sessions.length - 1 - idx})">
      Supprimer cette s√©ance
    </button>
  </div>
`;

      });

      container.innerHTML = html;
    }

    function deleteSession(index) {
  const key = "structured-sessions";
  const raw = localStorage.getItem(key);
  if (!raw) return;

  const sessions = JSON.parse(raw);

  // V√©rification si l‚Äôindex est valide
  if (index < 0 || index >= sessions.length) return;

  // Suppression de la s√©ance
  sessions.splice(index, 1);

  // Sauvegarde
  localStorage.setItem(key, JSON.stringify(sessions));

  // Mise √† jour de l‚Äôaffichage
  renderStructuredSessionsHistory();
}

    let exerciseChart = null;

    function getStructuredSessions() {
      const raw = localStorage.getItem("structured-sessions");
      if (!raw) return [];
      try {
        const sessions = JSON.parse(raw);
        // Tri chronologique : plus anciennes ‚Üí plus r√©centes
        sessions.sort((a, b) => new Date(a.date) - new Date(b.date));

        return sessions;
      } catch {
        return [];
      }
    }

    function updateMetricOptions() {
      const exerciseSelect = document.getElementById("dashboard-exercise");
      const metricSelect = document.getElementById("dashboard-metric");
      if (!exerciseSelect || !metricSelect) return;

      const exName = exerciseSelect.value;
      metricSelect.innerHTML = "";

      let options = [];

      if (isHoldExercise(exName)) {
        // Exos √† hold
        options = [
          { value: "avg_hold", label: "Moyenne des holds" },
          { value: "max_hold", label: "Max des holds" },
          { value: "count_hold", label: "Nombre de holds" },
        ];
      } else {
        // Exos √† r√©p√©titions
        options = [
          { value: "sum_reps", label: "Somme des reps" },
          { value: "avg_reps", label: "Moyenne des reps" },
          { value: "count_sets", label: "Nombre de s√©ries" },
        ];
      }

      options.forEach(opt => {
        const o = document.createElement("option");
        o.value = opt.value;
        o.textContent = opt.label;
        metricSelect.appendChild(o);
      });
    }

    function buildChartData(exerciseName, metricKey) {
      const sessions = getStructuredSessions();
      const labels = [];
      const data = [];

      sessions.forEach(s => {
        const exercises = s.exercises || [];
        const matching = exercises.filter(ex => ex.name === exerciseName);
        if (!matching.length) return;

        // On agr√®ge toutes les s√©ries de cet exo dans la s√©ance
        let values = [];
        matching.forEach(ex => {
          const nums = [ex.s1, ex.s2, ex.s3, ex.s4,ex.s5,ex.s6,ex.s7,ex.s8]
            .map(v => Number(v))
            .filter(v => !isNaN(v) && v > 0);
          values = values.concat(nums);
        });

        if (!values.length) return;

        let pointValue = 0;

        if (isHoldExercise(exerciseName)) {
          const sum = values.reduce((a, b) => a + b, 0);
          const avg = sum / values.length;
          const max = Math.max(...values);
          const count = values.length;

          if (metricKey === "avg_hold") pointValue = avg;
          else if (metricKey === "max_hold") pointValue = max;
          else if (metricKey === "count_hold") pointValue = count;
        } else {
          const sum = values.reduce((a, b) => a + b, 0);
          const count = values.length;
          const avg = sum / count;

          if (metricKey === "sum_reps") pointValue = sum;
          else if (metricKey === "avg_reps") pointValue = avg;
          else if (metricKey === "count_sets") pointValue = count;
        }

        const d = new Date(s.date);
        const dateStr = isNaN(d.getTime()) ? s.date : d.toLocaleDateString();
        labels.push(dateStr);
        data.push(pointValue);
      });

      return { labels, data };
    }

    function renderExerciseChart() {
      const exerciseSelect = document.getElementById("dashboard-exercise");
      const metricSelect = document.getElementById("dashboard-metric");
      const info = document.getElementById("dashboard-info");
      const ctx = document.getElementById("exercise-chart");

      if (!exerciseSelect || !metricSelect || !ctx) return;

      const exerciseName = getSelectedExerciseName();
      if (!exerciseName) {
        info.textContent = "Choisis un exercice ou saisis un nom pour l'exercice personnalis√©.";
        if (exerciseChart) { exerciseChart.destroy(); exerciseChart = null; }
        return;
      }

      const metricKey = metricSelect.value;
      localStorage.setItem("last-selected-exercise-select", exerciseSelect.value);

      localStorage.setItem("last-selected-exercise", exerciseName);
      localStorage.setItem("last-selected-metric", metricKey);

      const { labels, data } = buildChartData(exerciseName, metricKey);

      if (!labels.length) {
        info.textContent = "Aucune donn√©e trouv√©e pour cet exercice et cette m√©trique.";
        if (exerciseChart) {
          exerciseChart.destroy();
          exerciseChart = null;
        }
        return;
      }

      info.textContent = "";

      if (exerciseChart) {
        exerciseChart.destroy();
      }

      exerciseChart = new Chart(ctx, {
      type: "line",
      data: {
        labels,
        datasets: [{
          label: `${exerciseName} ‚Äì ${metricSelect.options[metricSelect.selectedIndex].text}`,
          data,
          borderWidth: 2,
          tension: 0.2,
          pointRadius: 3
        }]
      },
      plugins: [ChartDataLabels],
      options: {
        responsive: true,
        maintainAspectRatio: false,
        layout: {
        padding: { top: 24, right: 8, left: 4 }
        },
        scales: {
          x: {
            title: { display: true, text: "S√©ances" }
          },
          y: {
            title: { display: true, text: "Valeur" },
            beginAtZero: true
          }
        },
        plugins: {
          legend: {
            position: 'bottom'
          },
          datalabels: {
            anchor: "end",
            align: "top",
            offset: 4,
            font: {
              size: 10
            },
            formatter: (value) => {
              // entier -> "5", sinon -> "5.2"
              return Number.isInteger(value) ? value : value.toFixed(1);
            }
          }
        }
      }
    });

    }

    function initDashboard() {
      const exerciseSelect = document.getElementById("dashboard-exercise");
      const metricSelect = document.getElementById("dashboard-metric");
      if (!exerciseSelect || !metricSelect) return;

      const customInput = document.getElementById("custom-exercise");

      // 1) Restaurer l'√©tat du select (y compris __custom__) AVANT le reste
      const savedSelect = localStorage.getItem("last-selected-exercise-select");
      if (savedSelect) {
        const exists = Array.from(exerciseSelect.options).some(o => o.value === savedSelect);
        if (exists) exerciseSelect.value = savedSelect;
      }

      function syncCustomUI() {
        if (!customInput) return;

        const isCustom = (exerciseSelect.value === "__custom_reps__" || exerciseSelect.value === "__custom_hold__");
        customInput.style.display = isCustom ? "block" : "none";

        if (isCustom) {
          const key = (exerciseSelect.value === "__custom_hold__")
            ? "custom-hold-exercise-name"
            : "custom-reps-exercise-name";

          const savedName = localStorage.getItem(key) || "";
          if (!customInput.value) customInput.value = savedName;
        }

        customInput.style.display = isCustom ? "block" : "none";

        if (isCustom) {
          const savedName = localStorage.getItem("custom-exercise-name") || "";
          if (!customInput.value) customInput.value = savedName;
        }
      }

      // 2) Sync UI custom maintenant que le select est restaur√©
      syncCustomUI();

      // 3) G√©n√©rer les m√©triques selon l'exercice courant
      updateMetricOptions();

      // 4) Restaurer la m√©trique apr√®s g√©n√©ration des options
      const savedMetric = localStorage.getItem("last-selected-metric");
      if (savedMetric) {
        const exists = Array.from(metricSelect.options).some(o => o.value === savedMetric);
        if (exists) metricSelect.value = savedMetric;
      }

      // 5) Rendu initial
      renderExerciseChart();

      // Listeners
      exerciseSelect.addEventListener("change", () => {
        syncCustomUI();
        updateMetricOptions();
        renderExerciseChart();
      });

      metricSelect.addEventListener("change", () => {
        renderExerciseChart();
      });

      if (customInput) {
        customInput.addEventListener("input", () => {
          const name = (customInput.value || "").trim();
          const key = (exerciseSelect.value === "__custom_hold__")
            ? "custom-hold-exercise-name"
            : "custom-reps-exercise-name";

          localStorage.setItem(key, name);

          renderExerciseChart();
        });
      }
    }


       



    function initStructuredLog() {
      // au moins une ligne vide par d√©faut
      addExerciseRow();
    }

    /* ---------- JOURNAL LIBRE (NOTES) ---------- */

    function showPost(id) {
      for (let i = 1; i <= 4; i++) {
        const post = document.getElementById("post-" + i);
        const btn = document.getElementById("btn-post-" + i);
        if (i === id) {
          post.style.display = "block";
          btn.classList.add("active");
        } else {
          post.style.display = "none";
          btn.classList.remove("active");
        }
      }
    }

    function savePost(id) {
      const textarea = document.getElementById("textarea-" + id);
      const info = document.getElementById("info-" + id);
      const key = "journal-content-" + id;

      localStorage.setItem(key, textarea.value);
      const now = new Date().toLocaleString();
      info.textContent = "Enregistr√© le " + now + " (stock√© dans ce navigateur uniquement)";
    }

    function resetPost(id) {
      const textarea = document.getElementById("textarea-" + id);
      const info = document.getElementById("info-" + id);
      const key = "journal-content-" + id;

      textarea.value = "";
      localStorage.removeItem(key);
      info.textContent = "";
    }

    function loadPosts() {
      for (let i = 1; i <= 4; i++) {
        const textarea = document.getElementById("textarea-" + i);
        const info = document.getElementById("info-" + i);
        const key = "journal-content-" + i;

        const saved = localStorage.getItem(key);
        if (saved !== null) {
          textarea.value = saved;
          info.textContent = "Contenu r√©cup√©r√© depuis ce navigateur.";
        }
      }
      showPost(1);
    }

      window.addEventListener("DOMContentLoaded", () => {
        initStructuredLog();
        loadPosts();

        const exerciseSelect = document.getElementById("dashboard-exercise");

        const savedSelect = localStorage.getItem("last-selected-exercise-select");
        if (savedSelect && exerciseSelect) {
          exerciseSelect.value = savedSelect;
        }        
        const savedExercise = localStorage.getItem("last-selected-exercise");

        if (savedExercise && exerciseSelect) exerciseSelect.value = savedExercise;
        if (!savedSelect) {
        const savedExercise = localStorage.getItem("last-selected-exercise");
        if (savedExercise && exerciseSelect) exerciseSelect.value = savedExercise;
      }
        renderStructuredSessionsHistory();
        initDashboard(); // initDashboard s‚Äôoccupe de la m√©trique + du rendu du chart
      });

  </script>

  <script>
  function uiInfo(msg) {
    const el = document.getElementById("community-info");
    if (el) el.textContent = msg || "";
  }

  async function signup() {
    const email = document.getElementById("auth-email").value.trim();
    const password = document.getElementById("auth-pass").value.trim();
    if (!email || !password) return uiInfo("Email + mot de passe requis.");

    const { error } = await supabase.auth.signUp({ email, password });
    if (error) return uiInfo("Erreur inscription: " + error.message);
    uiInfo("Inscription OK. V√©rifie tes emails si demand√©, puis connecte-toi.");
  }

  async function login() {
    const email = document.getElementById("auth-email").value.trim();
    const password = document.getElementById("auth-pass").value.trim();
    if (!email || !password) return uiInfo("Email + mot de passe requis.");

    const { error } = await supabase.auth.signInWithPassword({ email, password });
    if (error) return uiInfo("Erreur login: " + error.message);
    uiInfo("Connect√©.");
  }
  
async function getOrCreateUsername(inputUsername) {
  const { data: auth } = await supabase.auth.getUser();
  const user = auth?.user;
  if (!user) return null;

  // 1) Lire le profil existant (0 ligne = OK)
  const { data: profile, error: selectError } = await supabase
    .from("user_profiles")
    .select("username")
    .eq("user_id", user.id)
    .maybeSingle(); // üîë IMPORTANT

  if (selectError) {
    console.error(selectError);
    throw selectError;
  }

  if (profile?.username) return profile.username;

  // 2) Cr√©er le pseudo
  const username = inputUsername.trim();
  if (!username) return null;

  const { error: insertError } = await supabase
    .from("user_profiles")
    .insert({ user_id: user.id, username });

  if (insertError) {
    if (insertError.code === "23505") {
      throw new Error("USERNAME_TAKEN");
    }
    throw insertError;
  }

  return username;
}


  async function logout() {
    await supabase.auth.signOut();
    uiInfo("D√©connect√©.");
  }

  // Publie la DERNI√àRE s√©ance stock√©e dans ton localStorage "structured-sessions"
  async function publishLastSession() {
    uiInfo("");

    const { data: authData } = await supabase.auth.getUser();
    console.log("AUTH USER:", authData);

    const user = authData?.user;
    if (!user) return uiInfo("Tu dois √™tre connect√© pour publier.");

    
    const inputUsername = document.getElementById("public-username").value;

  let username;
  try {
    username = await getOrCreateUsername(inputUsername);
  } catch (e) {
    return uiInfo("Ce pseudo est d√©j√† utilis√©.");
  }

  if (!username) {
    return uiInfo("Choisis un pseudo (une seule fois).");
  }


    const raw = localStorage.getItem("structured-sessions");
    const sessions = raw ? JSON.parse(raw) : [];
    if (!sessions.length) return uiInfo("Aucune s√©ance √† publier (journal structur√© vide).");

    const last = sessions[sessions.length - 1];
    if (!last?.date) return uiInfo("Ta derni√®re s√©ance n‚Äôa pas de date.");

    const row = {
      user_id: user.id,
      username,
      session_date: last.date,
      payload: last
    };
    console.log("INSERT PAYLOAD:", row);
    const { data, error } = await supabase
      .from("workout_sessions")
      .insert(row)
      .select();

    console.log("INSERT RESULT:", data, error);

    if (error) return uiInfo("Erreur publication: " + error.message);

    uiInfo("S√©ance publi√©e ‚úÖ");
    await loadPublicFeed();
  }
  
  async function initUsernameUI() {
  const input = document.getElementById("public-username");
  if (!input) return;

  const { data: auth } = await supabase.auth.getUser();
  const user = auth?.user;
  if (!user) return;

  const { data: profile } = await supabase
    .from("user_profiles")
    .select("username")
    .eq("user_id", user.id)
    .maybeSingle();

  if (profile?.username) {
    input.value = profile.username;
    input.disabled = true;
    input.title = "Pseudo d√©finitif";
  }
}
 window.addEventListener("DOMContentLoaded", initUsernameUI);


  function renderFeedItem(s, currentUserId) {
  const d = new Date(s.session_date);
  const dateLabel = isNaN(d.getTime()) ? s.session_date : d.toLocaleDateString();

  const exList = (s.payload?.exercises || [])
    .slice(0, 6)
    .map(ex => {
      const series = [ex.s1, ex.s2, ex.s3, ex.s4, ex.s5, ex.s6, ex.s7, ex.s8]
        .filter(v => v !== "" && v !== null && v !== undefined)
        .join("/");
      return `<li>${escapeHtml(ex.name || "Exo")} ${series ? `‚Äî ${escapeHtml(series)}` : ""}</li>`;
    })
    .join("");

  const canDelete = currentUserId && s.user_id === currentUserId;

  return `
    <div style="background:#f5f5f5;border:1px solid #eee;border-radius:12px;padding:12px;">
      <div style="display:flex;justify-content:space-between;gap:10px;align-items:baseline;">
        <strong>${escapeHtml(s.username)}</strong>
        <span style="font-size:12px;color:#666;">${escapeHtml(dateLabel)}</span>
      </div>
      <div style="font-size:12px;color:#666;margin-top:4px;">
        Dur√©e: ${escapeHtml(String(s.payload?.duration || ""))} min
      </div>
      <ul style="margin:8px 0 0;padding-left:18px;font-size:13px;">
        ${exList || "<li>(s√©ance vide)</li>"}
      </ul>

      ${canDelete ? `
        <button class="delete-session-btn" type="button" onclick="deleteSession(${s.id})">
          Supprimer cette publication
        </button>
      ` : ""}
    </div>
  `;
}

  
  function escapeHtml(str) {
    return str.replace(/[&<>"']/g, m => ({
      "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
    }[m]));
  }


  async function loadPublicFeed() {
    const container = document.getElementById("public-feed");
    if (!container) return;

    const { data, error } = await supabase
      .from("workout_sessions")
      .select("id, user_id, created_at, username, session_date, payload")
      .order("created_at", { ascending: false })
      .limit(20);
    const { data: authData } = await supabase.auth.getUser();
    const currentUserId = authData?.user?.id || null;

    if (error) {
      container.innerHTML = `<div style="font-size:13px;color:#a00;">Erreur feed: ${escapeHtml(error.message)}</div>`;
      return;
    }

    container.innerHTML = (data || []).map(s => renderFeedItem(s, currentUserId)).join("");
  }

    async function deleteSession(sessionId) {
  const ok = confirm("Supprimer d√©finitivement cette s√©ance ?");
  if (!ok) return;

  const { error } = await supabase
    .from("workout_sessions")
    .delete()
    .eq("id", sessionId);

  if (error) {
    alert("Erreur suppression : " + error.message);
    return;
  }

  await loadPublicFeed();
}


  window.addEventListener("DOMContentLoaded", () => {
    loadPublicFeed();
  });
</script>

</body>
</html>
