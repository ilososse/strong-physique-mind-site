(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&l(o)}).observe(document,{childList:!0,subtree:!0});function i(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(s){if(s.ep)return;s.ep=!0;const r=i(s);fetch(s.href,r)}})();function S(t){return Math.max(0,Math.min(1,t))}function n(t,e=.5){return!!t&&(t.visibility??0)>=e}function g(t,e,i){if(!t||!e||!i)return null;const l=t.x-e.x,s=t.y-e.y,r=(t.z??0)-(e.z??0),o=i.x-e.x,u=i.y-e.y,a=(i.z??0)-(e.z??0),c=l*o+s*u+r*a,h=Math.sqrt(l*l+s*s+r*r),f=Math.sqrt(o*o+u*u+a*a);if(h===0||f===0)return null;const y=Math.max(-1,Math.min(1,c/(h*f)));return Math.acos(y)*180/Math.PI}function V(t){return t.length?t.reduce((e,i)=>e+i,0)/t.length:null}function D(t,e=180,i=!1){if(t==null)return null;const l=Math.abs(e-t),s=i?4:0;return l<=5+s?10:l<=10+s?8:l<=20+s?6:l<=30+s?4:2}function q(t,e,i=!1){if(!t||!e)return null;const l=e.x-t.x,s=e.y-t.y,o=Math.atan2(Math.abs(l),Math.abs(s))*180/Math.PI,u=i?2:0;return o<=3+u?10:o<=6+u?8:o<=10+u?6:o<=15+u?4:2}function M(t){return t==null?null:t<=75?10:t<=80?9:t<=85?8:t<=90?7:t<=100?6:t<=110?5:t<=120?4:t<=130?3:2}function L(t,e){if(!(e!=null&&e._poseMetrics))return null;const i=e._poseMetrics(t),l=i.shWrXL==null?i.shWrXR:i.shWrXR==null?i.shWrXL:(i.shWrXL+i.shWrXR)/2;let s=null;l!=null&&e.name!=="Tuck planche"&&e.name!=="Adv. tuck planche"&&(l>=.16?s=10:l>=.14?s=8:l>=.12?s=6:l>=.1?s=4:s=2);const r=i.shHipYL==null?i.shHipYR:i.shHipYR==null?i.shHipYL:(i.shHipYL+i.shHipYR)/2;let o=null;r!=null&&(r<=.04?o=10:r<=.06?o=8:r<=.1?o=6:r<=.15?o=4:o=2);let u=null;if(e.name==="Straddle planche"||e.name==="Full planche"||e.name==="Planche lean"){const d=i.aL==null?i.aR:i.aR==null?i.aL:(i.aL+i.aR)/2;if(d!=null){const p=Math.abs(170-d);p<=5?u=10:p<=10?u=8:p<=15?u=6:p<=20?u=4:u=2}}let a=null;if(e.name==="Adv. tuck planche"){const d=i.khsAngleL==null?i.khsAngleR:i.khsAngleR==null?i.khsAngleL:(i.khsAngleL+i.khsAngleR)/2;d!=null&&(d>=85?a=10:d>=80?a=8:d>=75?a=6:d>=70?a=4:a=2)}let c=null;if(e.name==="Straddle planche"||e.name==="Full planche"||e.name==="Planche lean"||e.name==="Front Lever"){const d=i.hkaAngleL==null?i.hkaAngleR:i.hkaAngleR==null?i.hkaAngleL:(i.hkaAngleL+i.hkaAngleR)/2;if(d!=null){const p=Math.abs(175-d);p<=5?c=10:p<=10?c=8:p<=15?c=6:p<=20?c=4:c=2}}let h=0,f=0;const y=e.name==="Straddle planche"||e.name==="Full planche",b=y?.4:1,v=y?.5:1;return s!=null&&(h+=s*b,f+=b),o!=null&&(h+=o*1,f+=1),u!=null&&(h+=u*1,f+=1),a!=null&&(h+=a*1,f+=1),c!=null&&(h+=c*v,f+=v),console.log(`[${e.name}] Scores - Lean: ${s} (poids: ${b}), Trunk: ${o}, Alignment: ${u}, KneeHipShoulder: ${a}, StraightLegs: ${c}`),f===0?{avgScore:null,leanScore:s,trunkScore:o,alignmentScore:u,kneeHipShoulderScore:a,straightLegsScore:c}:{avgScore:Math.round(h/f*10)/10,leanScore:s,trunkScore:o,alignmentScore:u,kneeHipShoulderScore:a,straightLegsScore:c}}function _(t,e=.02,i=.1){const l=(t-e)/(i-e);return Math.round(S(l)*10*10)/10}function R(t){const e=t[11],i=t[12],l=t[23],s=t[24];let r=null;if(e&&i&&l&&s){const a=(e.y+i.y)/2,c=(l.y+s.y)/2,h=Math.abs(a-c);h<=.04?r=10:h<=.06?r=8:h<=.1?r=6:h<=.15?r=4:r=2}let o=0,u=0;return r!=null&&(o+=r,u++),u===0?null:{avgScore:Math.round(o/u*10)/10,trunkScore:r}}function P(t,e={}){return{name:t,mode:"hold",tracking:"timer",initState:"off",activeState:"on",idleEndState:"off",requireShouldersAheadOfWrists:!0,shWrXStartMin:.16,shWrXStopMin:.155,armTorsoMaxDeg:130,requiredVisibility:.45,straightStartDeg:130,straightStopDeg:128,hysteresisDeg:2,shHipYStartMax:.19,shHipYStopMax:.23,hkaAngleMinStop:130,sidePolicy:"either",...e}}const Y={name:"Tractions",mode:"reps",initState:"hanging",activeState:"pulling",idleEndState:"pulling",startHeadVsElbow:-.02,completeHeadVsWrist:.04,requiredVisibility:.5,canStart(t){const e=t[0],i=t[13],l=t[14];if(!n(e,this.requiredVisibility)||!n(i,this.requiredVisibility)||!n(l,this.requiredVisibility))return!1;const s=e.y,r=(i.y+l.y)/2;return s>r+this.startHeadVsElbow},canComplete(t){const e=t[0],i=t[15],l=t[16];if(!n(e,this.requiredVisibility)||!n(i,this.requiredVisibility)||!n(l,this.requiredVisibility))return!1;const s=e.y,r=(i.y+l.y)/2;return s<=r+this.completeHeadVsWrist},getAscentSignal(t){const e=t[0];return n(e,.5)?e.y:null}},H={name:"Pompes",mode:"reps",initState:"up",activeState:"down",idleEndState:"up",topAngleDeg:149,bottomAngleDeg:110,requiredVisibility:.45,armPolicy:"either",hysteresisDeg:3,maxTrunkVerticalDelta:.35,minHipVisibility:.5,_elbowAngles(t){const e=t[11],i=t[12],l=t[13],s=t[14],r=t[15],o=t[16],u=n(e,this.requiredVisibility)&&n(l,this.requiredVisibility)&&n(r,this.requiredVisibility),a=n(i,this.requiredVisibility)&&n(s,this.requiredVisibility)&&n(o,this.requiredVisibility),c=u?g(e,l,r):null,h=a?g(i,s,o):null;return{aL:c,aR:h}},_effectiveAngle(t){const{aL:e,aR:i}=this._elbowAngles(t);return this.armPolicy==="both"?e==null||i==null?null:(e+i)/2:e==null&&i==null?null:e==null?i:i==null?e:(e+i)/2},_isBodyHorizontal(t){const e=t[11],i=t[12],l=t[23],s=t[24];if(!n(e,this.requiredVisibility)||!n(i,this.requiredVisibility))return console.log("[Pompes][CTX] Shoulder not visible"),!1;const r=(e.y+i.y)/2;if(n(l,this.minHipVisibility)&&n(s,this.minHipVisibility)){const o=(l.y+s.y)/2,u=Math.abs(r-o);return console.log(`[Pompes][CTX] Hip visible | deltaY=${u.toFixed(3)} | threshold=${this.maxTrunkVerticalDelta}`),u>this.maxTrunkVerticalDelta?(console.log("[Pompes][CTX] ‚ùå Body not horizontal (deltaY too large)"),!1):(console.log("[Pompes][CTX] ‚úÖ Horizontal via hip"),!0)}return console.log(`[Pompes][CTX] Hip NOT visible | avgShoulderY=${r.toFixed(3)}`),console.log("[Pompes][CTX] ‚úÖ Horizontal via fallback"),!0},canStart(t){if(!this._isBodyHorizontal(t))return!1;const i=this._effectiveAngle(t);return i==null?(console.log("[Pompes][START] Angle null"),!1):(console.log(`[Pompes][START] angle=${i.toFixed(1)} | threshold=${this.bottomAngleDeg+this.hysteresisDeg}`),i<=this.bottomAngleDeg+this.hysteresisDeg)},canComplete(t){if(!this._isBodyHorizontal(t))return!1;const i=this._effectiveAngle(t);return i==null?(console.log("[Pompes][COMPLETE] Angle null"),!1):(console.log(`[Pompes][COMPLETE] angle=${i.toFixed(1)} | threshold=${this.topAngleDeg-this.hysteresisDeg}`),i>=this.topAngleDeg-this.hysteresisDeg)},getAscentSignal(t){const e=t[11],i=t[12];return!n(e,.35)||!n(i,.35)?null:(e.y+i.y)/2}},T={name:"Handstand",mode:"hold",tracking:"timer",initState:"off",activeState:"on",idleEndState:"off",requiredVisibility:.4,invertMarginY:.06,straightStartDeg:155,straightStopDeg:140,hysteresisDeg:3,sidePolicy:"either",_bodyAnglesAndInversion(t){const e=t[11],i=t[12],l=t[23],s=t[24],r=t[27],o=t[28],u=n(e,this.requiredVisibility)&&n(l,this.requiredVisibility)&&n(r,this.requiredVisibility),a=n(i,this.requiredVisibility)&&n(s,this.requiredVisibility)&&n(o,this.requiredVisibility),c=u?g(e,l,r):null,h=a?g(i,s,o):null,f=u?r.y+this.invertMarginY<e.y:null,y=a?o.y+this.invertMarginY<i.y:null;return{aL:c,aR:h,invL:f,invR:y}},_effectiveStraightAngle(t){const{aL:e,aR:i}=this._bodyAnglesAndInversion(t);return this.sidePolicy==="both"?e==null||i==null?null:(e+i)/2:e==null&&i==null?null:e==null?i:i==null?e:(e+i)/2},_isInverted(t){const{invL:e,invR:i}=this._bodyAnglesAndInversion(t);return this.sidePolicy==="both"?e==null||i==null?!1:!!e&&!!i:e==null&&i==null?!1:e==null?!!i:i==null?!!e:!!e||!!i},canStart(t){if(!this._isInverted(t))return!1;const i=this._effectiveStraightAngle(t);return i==null?!1:i>=this.straightStartDeg-this.hysteresisDeg},canComplete(t){const e=this._isInverted(t),i=this._effectiveStraightAngle(t);return i!=null&&console.log(`[Handstand] Angle: ${i.toFixed(1)}¬∞ | Inverted: ${e} | Threshold: ${this.straightStopDeg-this.hysteresisDeg}¬∞`),!e||i==null?!0:i<=this.straightStopDeg-this.hysteresisDeg},getAscentSignal(t){const e=t[11],i=t[12];return!n(e,.35)||!n(i,.35)?null:(e.y+i.y)/2},_effectiveAngle(t){return this._effectiveStraightAngle(t)}},x={name:"Handstand Push Up",mode:"reps",initState:"top",activeState:"bottom",idleEndState:"top",endPolicy:"break_pose",breakPoseGraceMs:400,requiredVisibility:.45,invertMarginY:.06,topAngleDeg:148,bottomAngleDeg:110,hysteresisDeg:4,armPolicy:"either",sidePolicy:"either",finalizeLikeHandstand:!0,hasReachedTopPosition:!1,_isInverted(t){const e=t[11],i=t[12],l=t[27],s=t[28],r=n(e,.4)&&n(l,.4)&&l.y+this.invertMarginY<e.y,o=n(i,.4)&&n(s,.4)&&s.y+this.invertMarginY<i.y;return this.sidePolicy==="both"?r&&o:r||o},_elbowAngles(t){const e=t[11],i=t[12],l=t[13],s=t[14],r=t[15],o=t[16],u=n(e,.4)&&n(l,.4)&&n(r,.4),a=n(i,.4)&&n(s,.4)&&n(o,.4),c=u?g(e,l,r):null,h=a?g(i,s,o):null;return this.armPolicy==="both"?c==null||h==null?null:(c+h)/2:c??h},canStart(t){if(!this._isInverted(t))return!1;const e=this._elbowAngles(t);return e==null?!1:this.hasReachedTopPosition?e<=this.bottomAngleDeg+this.hysteresisDeg:(e>=this.topAngleDeg-this.hysteresisDeg&&(this.hasReachedTopPosition=!0,console.log(`üîí [HSPU] Position TOP atteinte (angle: ${e.toFixed(1)}¬∞), pr√™t √† compter les reps`)),!1)},canComplete(t){if(!this._isInverted(t))return!1;const e=this._elbowAngles(t);if(e==null)return!1;const i=e>=this.topAngleDeg-this.hysteresisDeg;return i&&(this.hasReachedTopPosition=!1,console.log("üîì [HSPU] Rep compl√©t√©e, flag r√©initialis√© pour la prochaine rep")),i},getAscentSignal(t){const e=t[11],i=t[12];return!n(e,.35)||!n(i,.35)?null:(e.y+i.y)/2},_bodyAlignment(t){const e=t[11],i=t[12],l=t[23],s=t[24],r=t[27],o=t[28],u=n(e,.4)&&n(i,.4),a=n(l,.4)&&n(s,.4),c=n(r,.4)&&n(o,.4);if(!u||!a||!c)return null;const h={x:(e.x+i.x)/2,y:(e.y+i.y)/2,z:((e.z??0)+(i.z??0))/2},f={x:(l.x+s.x)/2,y:(l.y+s.y)/2,z:((l.z??0)+(s.z??0))/2},y={x:(r.x+o.x)/2,y:(r.y+o.y)/2,z:((r.z??0)+(o.z??0))/2};return g(h,f,y)}},w={name:"90 Degree HSPU",mode:"reps",initState:"top",activeState:"bottom",idleEndState:"top",hasReachedInvertedLock:!1,endPolicy:"break_pose",breakPoseGraceMs:400,finalizeLikeHandstand:!0,requiredVisibility:.45,invertMarginY:.06,topAngleDeg:147,bottomAngleDeg:110,hysteresisDeg:3,armTorsoMaxDeg:130,armPolicy:"either",sidePolicy:"either",_isInverted(t){const e=t[11],i=t[12],l=t[27],s=t[28],r=n(e,.4)&&n(l,.4)&&l.y+this.invertMarginY<e.y,o=n(i,.4)&&n(s,.4)&&s.y+this.invertMarginY<i.y;return r||o},_poseMetrics(t){const e=t[11],i=t[12],l=t[13],s=t[14],r=t[15],o=t[16],u=t[23],a=t[24],c=n(e,this.requiredVisibility)&&n(l,this.requiredVisibility)&&n(r,this.requiredVisibility)&&n(u,this.requiredVisibility),h=n(i,this.requiredVisibility)&&n(s,this.requiredVisibility)&&n(o,this.requiredVisibility)&&n(a,this.requiredVisibility),f=c?g(e,l,r):null,y=h?g(i,s,o):null,b=c?g(l,e,u):null,v=h?g(s,i,a):null;return{elbowL:f,elbowR:y,armTorsoL:b,armTorsoR:v}},_avg(t,e){return t==null?e:e==null?t:(t+e)/2},_isInvertedLock(t){if(!this._isInverted(t))return!1;const{elbowL:e,elbowR:i,armTorsoL:l,armTorsoR:s}=this._poseMetrics(t),r=this._avg(e,i),o=this._avg(l,s);return r==null||o==null?!1:r>=this.topAngleDeg-this.hysteresisDeg&&o<=this.armTorsoMaxDeg},_bodyAlignment(t){const e=t[11],i=t[12],l=t[23],s=t[24],r=t[27],o=t[28],u=n(e,.4)&&n(i,.4),a=n(l,.4)&&n(s,.4),c=n(r,.4)&&n(o,.4);if(!u||!a||!c)return null;const h={x:(e.x+i.x)/2,y:(e.y+i.y)/2,z:((e.z??0)+(i.z??0))/2},f={x:(l.x+s.x)/2,y:(l.y+s.y)/2,z:((l.z??0)+(s.z??0))/2},y={x:(r.x+o.x)/2,y:(r.y+o.y)/2,z:((r.z??0)+(o.z??0))/2};return g(h,f,y)},canStart(t){if(!this._isInverted(t))return!1;if(!this.hasReachedInvertedLock)return this._isInvertedLock(t)&&(this.hasReachedInvertedLock=!0),!1;const{elbowL:e,elbowR:i,armTorsoL:l,armTorsoR:s}=this._poseMetrics(t),r=this._avg(e,i),o=this._avg(l,s);return r==null||o==null?!1:r<=this.bottomAngleDeg+this.hysteresisDeg&&o<=this.armTorsoMaxDeg},canComplete(t){if(!this._isInverted(t))return!1;const{elbowL:e,elbowR:i,armTorsoL:l,armTorsoR:s}=this._poseMetrics(t),r=this._avg(e,i),o=this._avg(l,s);if(r==null||o==null)return!1;const u=r>=this.topAngleDeg-this.hysteresisDeg&&o<=this.armTorsoMaxDeg;return u&&(this.hasReachedInvertedLock=!1),u},getAscentSignal(t){const e=t[11],i=t[12];return!n(e,.35)||!n(i,.35)?null:(e.y+i.y)/2}},z={name:"Dips",mode:"reps",initState:"top",activeState:"bottom",idleEndState:"top",requiredVisibility:.45,topAngleDeg:155,bottomAngleDeg:100,hysteresisDeg:4,armPolicy:"either",sidePolicy:"either",_elbowAngles(t){const e=t[11],i=t[12],l=t[13],s=t[14],r=t[15],o=t[16],u=n(e,this.requiredVisibility)&&n(l,this.requiredVisibility)&&n(r,this.requiredVisibility),a=n(i,this.requiredVisibility)&&n(s,this.requiredVisibility)&&n(o,this.requiredVisibility),c=u?g(e,l,r):null,h=a?g(i,s,o):null;return this.armPolicy==="both"?c==null||h==null?null:(c+h)/2:c??h},_shouldersAboveElbows(t){const e=t[11],i=t[12],l=t[13],s=t[14],r=n(e,.4)&&n(l,.4),o=n(i,.4)&&n(s,.4),u=r?e.y<l.y:null,a=o?i.y<s.y:null;return this.sidePolicy==="both"?u==null||a==null?!1:u&&a:u||a},canStart(t){const e=this._elbowAngles(t);return e==null?!1:e<=this.bottomAngleDeg+this.hysteresisDeg},canComplete(t){const e=this._elbowAngles(t);return e==null||e<this.topAngleDeg-this.hysteresisDeg?!1:this._shouldersAboveElbows(t)},getAscentSignal(t){const e=t[11],i=t[12];return!n(e,.35)||!n(i,.35)?null:(e.y+i.y)/2}},m={name:"Front Lever Raises",mode:"reps",initState:"hang",activeState:"front",idleEndState:"hang",requiredVisibility:.45,hysteresisDeg:2,armTorsoMaxDeg:135,shHipYMax:.08,hipAnkleYMax:.12,sidePolicy:"either",_poseMetrics(t){const e=t[11],i=t[12],l=t[13],s=t[14],r=t[23],o=t[24],u=t[27],a=t[28],c=n(e,this.requiredVisibility)&&n(l,this.requiredVisibility)&&n(r,this.requiredVisibility)&&n(u,this.requiredVisibility),h=n(i,this.requiredVisibility)&&n(s,this.requiredVisibility)&&n(o,this.requiredVisibility)&&n(a,this.requiredVisibility),f=c?g(l,e,r):null,y=h?g(s,i,o):null,b=c?Math.abs(e.y-r.y):null,v=h?Math.abs(i.y-o.y):null,A=c?Math.abs(r.y-u.y):null,d=h?Math.abs(o.y-a.y):null;return{armTorsoL:f,armTorsoR:y,shHipYL:b,shHipYR:v,hipAnkYL:A,hipAnkYR:d}},_avg(t,e){return t==null?e:e==null?t:(t+e)/2},canStart(t){const e=this._poseMetrics(t),i=this._avg(e.armTorsoL,e.armTorsoR),l=this._avg(e.shHipYL,e.shHipYR),s=this._avg(e.hipAnkYL,e.hipAnkYR);return!(i==null||l==null||s==null||i>this.armTorsoMaxDeg+this.hysteresisDeg||l>this.shHipYMax||s>this.hipAnkleYMax)},canComplete(t){const e=this._poseMetrics(t),i=this._avg(e.shHipYL,e.shHipYR),l=this._avg(e.hipAnkYL,e.hipAnkYR);return i==null||l==null?!1:i>this.shHipYMax+this.hysteresisDeg||l>this.hipAnkleYMax+this.hysteresisDeg},getAscentSignal(t){const e=t[11],i=t[12];return!n(e,.35)||!n(i,.35)?null:(e.y+i.y)/2},_elbowAngles(t){const e=t[11],i=t[12],l=t[13],s=t[14],r=t[15],o=t[16],u=n(e,this.requiredVisibility)&&n(l,this.requiredVisibility)&&n(r,this.requiredVisibility),a=n(i,this.requiredVisibility)&&n(s,this.requiredVisibility)&&n(o,this.requiredVisibility),c=u?g(e,l,r):null,h=a?g(i,s,o):null;return c==null&&h==null?null:c==null?h:h==null?c:(c+h)/2},_bodyAlignment(t){const e=t[11],i=t[12],l=t[23],s=t[24],r=t[27],o=t[28],u=n(e,this.requiredVisibility)&&n(i,this.requiredVisibility),a=n(l,this.requiredVisibility)&&n(s,this.requiredVisibility),c=n(r,this.requiredVisibility)&&n(o,this.requiredVisibility);if(!u||!a||!c)return null;const h={x:(e.x+i.x)/2,y:(e.y+i.y)/2,z:((e.z??0)+(i.z??0))/2},f={x:(l.x+s.x)/2,y:(l.y+s.y)/2,z:((l.z??0)+(s.z??0))/2},y={x:(r.x+o.x)/2,y:(r.y+o.y)/2,z:((r.z??0)+(o.z??0))/2};return g(h,f,y)}};export{z as D,m as F,x as H,w as N,H as P,Y as T,D as a,q as b,R as c,V as d,M as e,_ as f,S as g,T as h,P as i,g as j,L as s,n as v};
