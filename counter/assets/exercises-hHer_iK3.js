(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function i(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(s){if(s.ep)return;s.ep=!0;const l=i(s);fetch(s.href,l)}})();function S(t){return Math.max(0,Math.min(1,t))}function n(t,e=.5){return!!t&&(t.visibility??0)>=e}function g(t,e,i){if(!t||!e||!i)return null;const r=t.x-e.x,s=t.y-e.y,l=(t.z??0)-(e.z??0),o=i.x-e.x,u=i.y-e.y,c=(i.z??0)-(e.z??0),h=r*o+s*u+l*c,a=Math.sqrt(r*r+s*s+l*l),f=Math.sqrt(o*o+u*u+c*c);if(a===0||f===0)return null;const y=Math.max(-1,Math.min(1,h/(a*f)));return Math.acos(y)*180/Math.PI}function D(t){return t.length?t.reduce((e,i)=>e+i,0)/t.length:null}function L(t,e=180,i=!1){if(t==null)return null;const r=Math.abs(e-t),s=i?4:0;return r<=5+s?10:r<=10+s?8:r<=20+s?6:r<=30+s?4:2}function M(t,e,i=!1){if(!t||!e)return null;const r=e.x-t.x,s=e.y-t.y,o=Math.atan2(Math.abs(r),Math.abs(s))*180/Math.PI,u=i?2:0;return o<=3+u?10:o<=6+u?8:o<=10+u?6:o<=15+u?4:2}function _(t){return t==null?null:t<=70?10:t<=80?8:t<=90?6:t<=100?4:2}function R(t,e){if(!(e!=null&&e._poseMetrics))return null;const i=e._poseMetrics(t),r=i.shWrXL==null?i.shWrXR:i.shWrXR==null?i.shWrXL:(i.shWrXL+i.shWrXR)/2;let s=null;r!=null&&e.name!=="Tuck planche"&&e.name!=="Adv. tuck planche"&&(r>=.16?s=10:r>=.14?s=8:r>=.12?s=6:r>=.1?s=4:s=2);const l=i.shHipYL==null?i.shHipYR:i.shHipYR==null?i.shHipYL:(i.shHipYL+i.shHipYR)/2;let o=null;l!=null&&(l<=.04?o=10:l<=.06?o=8:l<=.1?o=6:l<=.15?o=4:o=2);let u=null;if(e.name==="Straddle planche"||e.name==="Full planche"||e.name==="Planche lean"){const p=i.aL==null?i.aR:i.aR==null?i.aL:(i.aL+i.aR)/2;if(p!=null){const d=Math.abs(170-p);d<=5?u=10:d<=10?u=8:d<=15?u=6:d<=20?u=4:u=2}}let c=null;if(e.name==="Adv. tuck planche"){const p=i.khsAngleL==null?i.khsAngleR:i.khsAngleR==null?i.khsAngleL:(i.khsAngleL+i.khsAngleR)/2;p!=null&&(p>=85?c=10:p>=80?c=8:p>=75?c=6:p>=70?c=4:c=2)}let h=null;if(e.name==="Straddle planche"||e.name==="Full planche"||e.name==="Planche lean"||e.name==="Front Lever"){const p=i.hkaAngleL==null?i.hkaAngleR:i.hkaAngleR==null?i.hkaAngleL:(i.hkaAngleL+i.hkaAngleR)/2;if(p!=null){const d=Math.abs(175-p);d<=5?h=10:d<=10?h=8:d<=15?h=6:d<=20?h=4:h=2}}let a=0,f=0;const y=e.name==="Straddle planche"||e.name==="Full planche",b=y?.4:1,v=y?.5:1;return s!=null&&(a+=s*b,f+=b),o!=null&&(a+=o*1,f+=1),u!=null&&(a+=u*1,f+=1),c!=null&&(a+=c*1,f+=1),h!=null&&(a+=h*v,f+=v),console.log(`[${e.name}] Scores - Lean: ${s} (poids: ${b}), Trunk: ${o}, Alignment: ${u}, KneeHipShoulder: ${c}, StraightLegs: ${h}`),f===0?{avgScore:null,leanScore:s,trunkScore:o,alignmentScore:u,kneeHipShoulderScore:c,straightLegsScore:h}:{avgScore:Math.round(a/f*10)/10,leanScore:s,trunkScore:o,alignmentScore:u,kneeHipShoulderScore:c,straightLegsScore:h}}function V(t,e={}){return{name:t,mode:"hold",tracking:"timer",initState:"off",activeState:"on",idleEndState:"off",requireShouldersAheadOfWrists:!0,shWrXStartMin:.16,shWrXStopMin:.155,armTorsoMaxDeg:130,requiredVisibility:.45,straightStartDeg:130,straightStopDeg:128,hysteresisDeg:2,shHipYStartMax:.19,shHipYStopMax:.23,hkaAngleMinStop:130,sidePolicy:"either",...e}}const q={name:"Tractions",mode:"reps",initState:"hanging",activeState:"pulling",idleEndState:"pulling",startHeadVsElbow:-.02,completeHeadVsWrist:.04,requiredVisibility:.5,canStart(t){const e=t[0],i=t[13],r=t[14];if(!n(e,this.requiredVisibility)||!n(i,this.requiredVisibility)||!n(r,this.requiredVisibility))return!1;const s=e.y,l=(i.y+r.y)/2;return s>l+this.startHeadVsElbow},canComplete(t){const e=t[0],i=t[15],r=t[16];if(!n(e,this.requiredVisibility)||!n(i,this.requiredVisibility)||!n(r,this.requiredVisibility))return!1;const s=e.y,l=(i.y+r.y)/2;return s<=l+this.completeHeadVsWrist},getAscentSignal(t){const e=t[0];return n(e,.5)?e.y:null}},Y={name:"Pompes",mode:"reps",initState:"up",activeState:"down",idleEndState:"up",topAngleDeg:149,bottomAngleDeg:110,requiredVisibility:.45,armPolicy:"either",hysteresisDeg:3,_elbowAngles(t){const e=t[11],i=t[12],r=t[13],s=t[14],l=t[15],o=t[16],u=n(e,this.requiredVisibility)&&n(r,this.requiredVisibility)&&n(l,this.requiredVisibility),c=n(i,this.requiredVisibility)&&n(s,this.requiredVisibility)&&n(o,this.requiredVisibility),h=u?g(e,r,l):null,a=c?g(i,s,o):null;return{aL:h,aR:a}},_effectiveAngle(t){const{aL:e,aR:i}=this._elbowAngles(t);return this.armPolicy==="both"?e==null||i==null?null:(e+i)/2:e==null&&i==null?null:e==null?i:i==null?e:(e+i)/2},canStart(t){const e=this._effectiveAngle(t);return e==null?!1:e<=this.bottomAngleDeg+this.hysteresisDeg},canComplete(t){const e=this._effectiveAngle(t);return e==null?!1:e>=this.topAngleDeg-this.hysteresisDeg},getAscentSignal(t){const e=t[11],i=t[12];return!n(e,.35)||!n(i,.35)?null:(e.y+i.y)/2}},P={name:"Handstand",mode:"hold",tracking:"timer",initState:"off",activeState:"on",idleEndState:"off",requiredVisibility:.4,invertMarginY:.06,straightStartDeg:155,straightStopDeg:140,hysteresisDeg:3,sidePolicy:"either",_bodyAnglesAndInversion(t){const e=t[11],i=t[12],r=t[23],s=t[24],l=t[27],o=t[28],u=n(e,this.requiredVisibility)&&n(r,this.requiredVisibility)&&n(l,this.requiredVisibility),c=n(i,this.requiredVisibility)&&n(s,this.requiredVisibility)&&n(o,this.requiredVisibility),h=u?g(e,r,l):null,a=c?g(i,s,o):null,f=u?l.y+this.invertMarginY<e.y:null,y=c?o.y+this.invertMarginY<i.y:null;return{aL:h,aR:a,invL:f,invR:y}},_effectiveStraightAngle(t){const{aL:e,aR:i}=this._bodyAnglesAndInversion(t);return this.sidePolicy==="both"?e==null||i==null?null:(e+i)/2:e==null&&i==null?null:e==null?i:i==null?e:(e+i)/2},_isInverted(t){const{invL:e,invR:i}=this._bodyAnglesAndInversion(t);return this.sidePolicy==="both"?e==null||i==null?!1:!!e&&!!i:e==null&&i==null?!1:e==null?!!i:i==null?!!e:!!e||!!i},canStart(t){if(!this._isInverted(t))return!1;const i=this._effectiveStraightAngle(t);return i==null?!1:i>=this.straightStartDeg-this.hysteresisDeg},canComplete(t){const e=this._isInverted(t),i=this._effectiveStraightAngle(t);return i!=null&&console.log(`[Handstand] Angle: ${i.toFixed(1)}Â° | Inverted: ${e} | Threshold: ${this.straightStopDeg-this.hysteresisDeg}Â°`),!e||i==null?!0:i<=this.straightStopDeg-this.hysteresisDeg},getAscentSignal(t){const e=t[11],i=t[12];return!n(e,.35)||!n(i,.35)?null:(e.y+i.y)/2},_effectiveAngle(t){return this._effectiveStraightAngle(t)}},m={name:"Handstand Push Up",mode:"reps",initState:"top",activeState:"bottom",idleEndState:"top",endPolicy:"break_pose",breakPoseGraceMs:400,requiredVisibility:.45,invertMarginY:.06,topAngleDeg:145,bottomAngleDeg:115,hysteresisDeg:3,armPolicy:"either",sidePolicy:"either",finalizeLikeHandstand:!0,hasReachedTopPosition:!1,_isInverted(t){const e=t[11],i=t[12],r=t[27],s=t[28],l=n(e,.4)&&n(r,.4)&&r.y+this.invertMarginY<e.y,o=n(i,.4)&&n(s,.4)&&s.y+this.invertMarginY<i.y;return this.sidePolicy==="both"?l&&o:l||o},_elbowAngles(t){const e=t[11],i=t[12],r=t[13],s=t[14],l=t[15],o=t[16],u=n(e,.4)&&n(r,.4)&&n(l,.4),c=n(i,.4)&&n(s,.4)&&n(o,.4),h=u?g(e,r,l):null,a=c?g(i,s,o):null;return this.armPolicy==="both"?h==null||a==null?null:(h+a)/2:h??a},canStart(t){if(!this._isInverted(t))return!1;const e=this._elbowAngles(t);return e==null?!1:this.hasReachedTopPosition?e<=this.bottomAngleDeg+this.hysteresisDeg:(e>=this.topAngleDeg-this.hysteresisDeg&&(this.hasReachedTopPosition=!0,console.log(`ðŸ”’ [HSPU] Position TOP atteinte (angle: ${e.toFixed(1)}Â°), prÃªt Ã  compter les reps`)),!1)},canComplete(t){if(!this._isInverted(t))return!1;const e=this._elbowAngles(t);if(e==null)return!1;const i=e>=this.topAngleDeg-this.hysteresisDeg;return i&&(this.hasReachedTopPosition=!1,console.log("ðŸ”“ [HSPU] Rep complÃ©tÃ©e, flag rÃ©initialisÃ© pour la prochaine rep")),i},getAscentSignal(t){const e=t[11],i=t[12];return!n(e,.35)||!n(i,.35)?null:(e.y+i.y)/2},_bodyAlignment(t){const e=t[11],i=t[12],r=t[23],s=t[24],l=t[27],o=t[28],u=n(e,.4)&&n(i,.4),c=n(r,.4)&&n(s,.4),h=n(l,.4)&&n(o,.4);if(!u||!c||!h)return null;const a={x:(e.x+i.x)/2,y:(e.y+i.y)/2,z:((e.z??0)+(i.z??0))/2},f={x:(r.x+s.x)/2,y:(r.y+s.y)/2,z:((r.z??0)+(s.z??0))/2},y={x:(l.x+o.x)/2,y:(l.y+o.y)/2,z:((l.z??0)+(o.z??0))/2};return g(a,f,y)}},w={name:"90 Degree HSPU",mode:"reps",initState:"top",activeState:"bottom",idleEndState:"top",hasReachedInvertedLock:!1,endPolicy:"break_pose",breakPoseGraceMs:400,finalizeLikeHandstand:!0,requiredVisibility:.45,invertMarginY:.06,topAngleDeg:145,bottomAngleDeg:110,hysteresisDeg:3,armTorsoMaxDeg:130,armPolicy:"either",sidePolicy:"either",_isInverted(t){const e=t[11],i=t[12],r=t[27],s=t[28],l=n(e,.4)&&n(r,.4)&&r.y+this.invertMarginY<e.y,o=n(i,.4)&&n(s,.4)&&s.y+this.invertMarginY<i.y;return l||o},_poseMetrics(t){const e=t[11],i=t[12],r=t[13],s=t[14],l=t[15],o=t[16],u=t[23],c=t[24],h=n(e,this.requiredVisibility)&&n(r,this.requiredVisibility)&&n(l,this.requiredVisibility)&&n(u,this.requiredVisibility),a=n(i,this.requiredVisibility)&&n(s,this.requiredVisibility)&&n(o,this.requiredVisibility)&&n(c,this.requiredVisibility),f=h?g(e,r,l):null,y=a?g(i,s,o):null,b=h?g(r,e,u):null,v=a?g(s,i,c):null;return{elbowL:f,elbowR:y,armTorsoL:b,armTorsoR:v}},_avg(t,e){return t==null?e:e==null?t:(t+e)/2},_isInvertedLock(t){if(!this._isInverted(t))return!1;const{elbowL:e,elbowR:i,armTorsoL:r,armTorsoR:s}=this._poseMetrics(t),l=this._avg(e,i),o=this._avg(r,s);return l==null||o==null?!1:l>=this.topAngleDeg-this.hysteresisDeg&&o<=this.armTorsoMaxDeg},_bodyAlignment(t){const e=t[11],i=t[12],r=t[23],s=t[24],l=t[27],o=t[28],u=n(e,.4)&&n(i,.4),c=n(r,.4)&&n(s,.4),h=n(l,.4)&&n(o,.4);if(!u||!c||!h)return null;const a={x:(e.x+i.x)/2,y:(e.y+i.y)/2,z:((e.z??0)+(i.z??0))/2},f={x:(r.x+s.x)/2,y:(r.y+s.y)/2,z:((r.z??0)+(s.z??0))/2},y={x:(l.x+o.x)/2,y:(l.y+o.y)/2,z:((l.z??0)+(o.z??0))/2};return g(a,f,y)},canStart(t){if(!this._isInverted(t))return!1;if(!this.hasReachedInvertedLock)return this._isInvertedLock(t)&&(this.hasReachedInvertedLock=!0),!1;const{elbowL:e,elbowR:i,armTorsoL:r,armTorsoR:s}=this._poseMetrics(t),l=this._avg(e,i),o=this._avg(r,s);return l==null||o==null?!1:l<=this.bottomAngleDeg+this.hysteresisDeg&&o<=this.armTorsoMaxDeg},canComplete(t){if(!this._isInverted(t))return!1;const{elbowL:e,elbowR:i,armTorsoL:r,armTorsoR:s}=this._poseMetrics(t),l=this._avg(e,i),o=this._avg(r,s);if(l==null||o==null)return!1;const u=l>=this.topAngleDeg-this.hysteresisDeg&&o<=this.armTorsoMaxDeg;return u&&(this.hasReachedInvertedLock=!1),u},getAscentSignal(t){const e=t[11],i=t[12];return!n(e,.35)||!n(i,.35)?null:(e.y+i.y)/2}},H={name:"Dips",mode:"reps",initState:"top",activeState:"bottom",idleEndState:"top",requiredVisibility:.45,topAngleDeg:155,bottomAngleDeg:100,hysteresisDeg:4,armPolicy:"either",sidePolicy:"either",_elbowAngles(t){const e=t[11],i=t[12],r=t[13],s=t[14],l=t[15],o=t[16],u=n(e,this.requiredVisibility)&&n(r,this.requiredVisibility)&&n(l,this.requiredVisibility),c=n(i,this.requiredVisibility)&&n(s,this.requiredVisibility)&&n(o,this.requiredVisibility),h=u?g(e,r,l):null,a=c?g(i,s,o):null;return this.armPolicy==="both"?h==null||a==null?null:(h+a)/2:h??a},_shouldersAboveElbows(t){const e=t[11],i=t[12],r=t[13],s=t[14],l=n(e,.4)&&n(r,.4),o=n(i,.4)&&n(s,.4),u=l?e.y<r.y:null,c=o?i.y<s.y:null;return this.sidePolicy==="both"?u==null||c==null?!1:u&&c:u||c},canStart(t){const e=this._elbowAngles(t);return e==null?!1:e<=this.bottomAngleDeg+this.hysteresisDeg},canComplete(t){const e=this._elbowAngles(t);return e==null||e<this.topAngleDeg-this.hysteresisDeg?!1:this._shouldersAboveElbows(t)},getAscentSignal(t){const e=t[11],i=t[12];return!n(e,.35)||!n(i,.35)?null:(e.y+i.y)/2}},T={name:"Front Lever Raises",mode:"reps",initState:"hang",activeState:"front",idleEndState:"hang",requiredVisibility:.45,hysteresisDeg:2,armTorsoMaxDeg:135,shHipYMax:.08,hipAnkleYMax:.12,sidePolicy:"either",_poseMetrics(t){const e=t[11],i=t[12],r=t[13],s=t[14],l=t[23],o=t[24],u=t[27],c=t[28],h=n(e,this.requiredVisibility)&&n(r,this.requiredVisibility)&&n(l,this.requiredVisibility)&&n(u,this.requiredVisibility),a=n(i,this.requiredVisibility)&&n(s,this.requiredVisibility)&&n(o,this.requiredVisibility)&&n(c,this.requiredVisibility),f=h?g(r,e,l):null,y=a?g(s,i,o):null,b=h?Math.abs(e.y-l.y):null,v=a?Math.abs(i.y-o.y):null,A=h?Math.abs(l.y-u.y):null,p=a?Math.abs(o.y-c.y):null;return{armTorsoL:f,armTorsoR:y,shHipYL:b,shHipYR:v,hipAnkYL:A,hipAnkYR:p}},_avg(t,e){return t==null?e:e==null?t:(t+e)/2},canStart(t){const e=this._poseMetrics(t),i=this._avg(e.armTorsoL,e.armTorsoR),r=this._avg(e.shHipYL,e.shHipYR),s=this._avg(e.hipAnkYL,e.hipAnkYR);return!(i==null||r==null||s==null||i>this.armTorsoMaxDeg+this.hysteresisDeg||r>this.shHipYMax||s>this.hipAnkleYMax)},canComplete(t){const e=this._poseMetrics(t),i=this._avg(e.shHipYL,e.shHipYR),r=this._avg(e.hipAnkYL,e.hipAnkYR);return i==null||r==null?!1:i>this.shHipYMax+this.hysteresisDeg||r>this.hipAnkleYMax+this.hysteresisDeg},getAscentSignal(t){const e=t[11],i=t[12];return!n(e,.35)||!n(i,.35)?null:(e.y+i.y)/2}};export{H as D,T as F,m as H,w as N,Y as P,q as T,M as a,L as b,D as c,_ as d,S as e,P as f,V as g,g as h,R as s,n as v};
